<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Sleep Outside | Cart</title>

    <link rel="stylesheet" href="/css/style.css" />

    <script src="../js/cart.js" type="module"></script>
  </head>

  <body>
    <header class="divider" id="main-header"></header>

    <main class="divider">
      <section class="products">
        <h2>My Cart</h2>

        <ul class="product-list"></ul>

        <!-- Adding HTML structure for the cart total - km -->
        <div class="cart-footer hide">
          <p class="cart-total">Total: $<span id="cart-total"></span></p>
        </div>
        
      </section>
    </main>

    <footer id="main-footer"></footer>

    <script type="text/javascript">
      // Fuad added this

      function remove_li(id) {
        let ul = document.querySelector(".product-list");
        let li = document.getElementById(id);
        ul.remove(li);

        let so_cart = JSON.parse(localStorage.getItem("so-cart"));
        let cartArray = [].concat(so_cart); //console.log(cartArray[0]["Brand"]["Id"]);
        let newArray = cartArray.filter((cart_item) => cart_item["Id"] !== id);

        const total = newArray.reduce((sum, item) => sum + item.FinalPrice, 0);
        document.getElementById("cart-total").textContent = total.toFixed(2);
        document.querySelector(".cart-footer").classList.add("show");

        // this logic it to check if the cart is empty and display an appropriate message if it is.
        document.querySelector("#cart-count").textContent = newArray.length;
        if (newArray.length == 0) {
          document.querySelector("#cart-count").style.display = "none";
        } else {
          document.querySelector("#cart-count").style.display = "";
        }

        localStorage.setItem("so-cart", JSON.stringify(newArray));
        location.reload();
      }
    </script>
  </body>
</html>
